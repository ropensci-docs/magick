<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="magick">
<title>The magick package: Advanced Image-Processing in R • magick</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The magick package: Advanced Image-Processing in R">
<meta property="og:description" content="magick">
<meta property="og:image" content="https://docs.ropensci.org/magick/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">magick</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.8.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/intro.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/magick">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>The magick package: Advanced Image-Processing in R</h1>
            
            <h4 data-toc-skip class="date">2024-03-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/magick/blob/HEAD/vignettes/intro.Rmd" class="external-link"><code>vignettes/intro.Rmd</code></a></small>
      <div class="d-none name"><code>intro.Rmd</code></div>
    </div>

    
    
<p>The <a href="https://cran.r-project.org/package=magick" class="external-link">magick</a> package provide a modern and simple toolkit for image processing in R. It wraps the <a href="https://www.imagemagick.org/Magick++/STL.html" class="external-link">ImageMagick STL</a> which is the most comprehensive open-source image processing library available today.</p>
<p>The ImageMagick library has an overwhelming amount of functionality. Magick exposes a decent subset of it, but it is impossible to document everything in detail. This article introduces some basic concepts and examples to get started.</p>
<div class="section level2">
<h2 id="installing-magick">Installing <code>magick</code><a class="anchor" aria-label="anchor" href="#installing-magick"></a>
</h2>
<p>On Windows or macOS the package is most easily installed via CRAN.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"magick"</span><span class="op">)</span></span></code></pre></div>
<p>The binary CRAN packages work out of the box and have most important features enabled. Use <code>magick_config</code> to see which features and formats are supported by your version of ImageMagick.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/magick/">magick</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linking to ImageMagick 6.9.11.60</span></span>
<span><span class="co">## Enabled features: fontconfig, freetype, fftw, heic, lcms, pango, webp, x11</span></span>
<span><span class="co">## Disabled features: cairo, ghostscript, raw, rsvg</span></span></code></pre>
<pre><code><span><span class="co">## Using 4 threads</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu">magick</span><span class="fu">::</span><span class="fu"><a href="../reference/config.html">magick_config</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 24</span></span>
<span><span class="co">##  $ version           :Class 'numeric_version'  hidden list of 1</span></span>
<span><span class="co">##   ..$ : int [1:4] 6 9 11 60</span></span>
<span><span class="co">##  $ modules           : logi TRUE</span></span>
<span><span class="co">##  $ cairo             : logi FALSE</span></span>
<span><span class="co">##  $ fontconfig        : logi TRUE</span></span>
<span><span class="co">##  $ freetype          : logi TRUE</span></span>
<span><span class="co">##  $ fftw              : logi TRUE</span></span>
<span><span class="co">##  $ ghostscript       : logi FALSE</span></span>
<span><span class="co">##  $ heic              : logi TRUE</span></span>
<span><span class="co">##  $ jpeg              : logi TRUE</span></span>
<span><span class="co">##  $ lcms              : logi TRUE</span></span>
<span><span class="co">##  $ libopenjp2        : logi TRUE</span></span>
<span><span class="co">##  $ lzma              : logi TRUE</span></span>
<span><span class="co">##  $ pangocairo        : logi TRUE</span></span>
<span><span class="co">##  $ pango             : logi TRUE</span></span>
<span><span class="co">##  $ png               : logi TRUE</span></span>
<span><span class="co">##  $ raw               : logi FALSE</span></span>
<span><span class="co">##  $ rsvg              : logi FALSE</span></span>
<span><span class="co">##  $ tiff              : logi TRUE</span></span>
<span><span class="co">##  $ webp              : logi TRUE</span></span>
<span><span class="co">##  $ wmf               : logi TRUE</span></span>
<span><span class="co">##  $ x11               : logi TRUE</span></span>
<span><span class="co">##  $ xml               : logi TRUE</span></span>
<span><span class="co">##  $ zero-configuration: logi FALSE</span></span>
<span><span class="co">##  $ threads           : int 4</span></span></code></pre>
<div class="section level3">
<h3 id="build-from-source">Build from source<a class="anchor" aria-label="anchor" href="#build-from-source"></a>
</h3>
<p>On Linux you need to install the ImageMagick++ library: on Debian/Ubuntu this is called <a href="https://packages.debian.org/testing/libmagick++-dev" class="external-link">libmagick++-dev</a>:</p>
<pre><code>sudo apt-get install libmagick++-dev</code></pre>
<p>On Fedora or CentOS/RHEL we need <a href="https://src.fedoraproject.org/rpms/ImageMagick" class="external-link">ImageMagick-c++-devel</a>:</p>
<pre><code>sudo yum install ImageMagick-c++-devel</code></pre>
<p>To install from source on macOS you need either <code>imagemagick@6</code> or <code>imagemagick</code> from homebrew.</p>
<pre><code>brew install imagemagick@6</code></pre>
<p>Unfortunately the current <code>imagemagick@6</code> configuration on homebrew disables a bunch of features, including librsvg and fontconfig. Therefore the quality of fonts and svg rendering might be suboptimal. The is not a problem for the CRAN binary package.</p>
</div>
</div>
<div class="section level2">
<h2 id="image-io">Image IO<a class="anchor" aria-label="anchor" href="#image-io"></a>
</h2>
<p>What makes magick so magical is that it automatically converts and renders all common image formats. ImageMagick supports dozens of formats and automatically detects the type. Use <code><a href="../reference/config.html">magick::magick_config()</a></code> to list the formats that your version of ImageMagick supports.</p>
<div class="section level3">
<h3 id="read-and-write">Read and write<a class="anchor" aria-label="anchor" href="#read-and-write"></a>
</h3>
<p>Images can be read directly from a file path, URL, or raw vector with image data with <code>image_read</code>. The <code>image_info</code> function shows some meta data about the image, similar to the imagemagick <code>identify</code> command line utility.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/magick/">magick</a></span><span class="op">)</span></span>
<span><span class="va">tiger</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/editing.html">image_read_svg</a></span><span class="op">(</span><span class="st">'http://jeroen.github.io/images/tiger.svg'</span>, width <span class="op">=</span> <span class="fl">350</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tiger</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   format width height colorspace matte filesize density</span></span>
<span><span class="co">## 1    PNG   350    350       sRGB  TRUE        0   72x72</span></span></code></pre>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-3-1.png"><!-- --></p>
<p>We use <code>image_write</code> to export an image in any format to a file on disk, or in memory if <code>path = NULL</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Render svg to png bitmap</span></span>
<span><span class="fu"><a href="../reference/editing.html">image_write</a></span><span class="op">(</span><span class="va">tiger</span>, path <span class="op">=</span> <span class="st">"tiger.png"</span>, format <span class="op">=</span> <span class="st">"png"</span><span class="op">)</span></span></code></pre></div>
<p>If <code>path</code> is a filename, <code>image_write</code> returns <code>path</code> on success such that the result can be piped into function taking a file path.</p>
</div>
<div class="section level3">
<h3 id="converting-formats">Converting formats<a class="anchor" aria-label="anchor" href="#converting-formats"></a>
</h3>
<p>Magick keeps the image in memory in its original format. Specify the <code>format</code> parameter <code>image_write</code> to convert to another format. You can also internally convert the image to another format earlier, before applying transformations. This can be useful if your original format is lossy.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tiger_png</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/editing.html">image_convert</a></span><span class="op">(</span><span class="va">tiger</span>, <span class="st">"png"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/attributes.html">image_info</a></span><span class="op">(</span><span class="va">tiger_png</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   format width height colorspace matte filesize density</span></span>
<span><span class="co">## 1    PNG   350    350       sRGB  TRUE        0   72x72</span></span></code></pre>
<p>Note that size is currently 0 because ImageMagick is lazy (in the good sense) and does not render until it has to.</p>
</div>
<div class="section level3">
<h3 id="preview">Preview<a class="anchor" aria-label="anchor" href="#preview"></a>
</h3>
<p>IDE’s with a built-in web browser (such as RStudio) automatically display magick images in the viewer. This results in a neat interactive image editing environment.</p>
<p><img alt="rstudio screenshot" data-external="1" src="https://jeroen.github.io/images/magick-rstudio.png"></p>
<p>Alternatively, on Linux you can use <code>image_display</code> to preview the image in an X11 window. Finally <code>image_browse</code> opens the image in your system’s default application for a given type.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># X11 only</span></span>
<span><span class="fu"><a href="../reference/editing.html">image_display</a></span><span class="op">(</span><span class="va">tiger</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># System dependent</span></span>
<span><span class="fu"><a href="../reference/editing.html">image_browse</a></span><span class="op">(</span><span class="va">tiger</span><span class="op">)</span></span></code></pre></div>
<p>Another method is converting the image to a raster object and plot it on R’s graphics display. However this is very slow and only useful in combination with other plotting functionality. See <a href="#raster-images">#raster</a> below.</p>
</div>
</div>
<div class="section level2">
<h2 id="transformations">Transformations<a class="anchor" aria-label="anchor" href="#transformations"></a>
</h2>
<p>The best way to get a sense of available transformations is walk through the examples in the <code>?transformations</code> help page in RStudio. Below a few examples to get a sense of what is possible.</p>
<div class="section level3">
<h3 id="cut-and-edit">Cut and edit<a class="anchor" aria-label="anchor" href="#cut-and-edit"></a>
</h3>
<p>Several of the transformation functions take an <code>geometry</code> parameter which requires a special syntax of the form <code>AxB+C+D</code> where each element is optional. Some examples:</p>
<ul>
<li>
<code>image_crop(image, "100x150+50")</code>: <em>crop out <code>width:100px</code> and <code>height:150px</code> starting <code>+50px</code> from the left</em>
</li>
<li>
<code>image_scale(image, "200")</code>: <em>resize proportionally to width: <code>200px</code></em>
</li>
<li>
<code>image_scale(image, "x200")</code>: <em>resize proportionally to height: <code>200px</code></em>
</li>
<li>
<code>image_fill(image, "blue", "+100+200")</code>: <em>flood fill with blue starting at the point at <code>x:100, y:200</code></em>
</li>
<li>
<code>image_border(frink, "red", "20x10")</code>: <em>adds a border of 20px left+right and 10px top+bottom</em>
</li>
</ul>
<p>The full syntax is specified in the <a href="http://www.imagemagick.org/Magick++/Geometry.html" class="external-link">Magick::Geometry</a> documentation.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example image</span></span>
<span><span class="va">frink</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/editing.html">image_read</a></span><span class="op">(</span><span class="st">"https://jeroen.github.io/images/frink.png"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">frink</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   format width height colorspace matte filesize density</span></span>
<span><span class="co">## 1    PNG   220    445       sRGB  TRUE    73494   72x72</span></span></code></pre>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-6-1.png"><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add 20px left/right and 10px top/bottom</span></span>
<span><span class="fu"><a href="../reference/composite.html">image_border</a></span><span class="op">(</span><span class="fu"><a href="../reference/color.html">image_background</a></span><span class="op">(</span><span class="va">frink</span>, <span class="st">"hotpink"</span><span class="op">)</span>, <span class="st">"#000080"</span>, <span class="st">"20x10"</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-6-2.png"><!-- --></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Trim margins</span></span>
<span><span class="fu"><a href="../reference/transform.html">image_trim</a></span><span class="op">(</span><span class="va">frink</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-6-3.png"><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Passport pica</span></span>
<span><span class="fu"><a href="../reference/transform.html">image_crop</a></span><span class="op">(</span><span class="va">frink</span>, <span class="st">"100x150+50"</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-6-4.png"><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Resize</span></span>
<span><span class="fu"><a href="../reference/transform.html">image_scale</a></span><span class="op">(</span><span class="va">frink</span>, <span class="st">"300"</span><span class="op">)</span> <span class="co"># width: 300px</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-6-5.png"><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/transform.html">image_scale</a></span><span class="op">(</span><span class="va">frink</span>, <span class="st">"x300"</span><span class="op">)</span> <span class="co"># height: 300px</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-6-6.png"><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Rotate or mirror</span></span>
<span><span class="fu"><a href="../reference/transform.html">image_rotate</a></span><span class="op">(</span><span class="va">frink</span>, <span class="fl">45</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-6-7.png"><!-- --></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/transform.html">image_flip</a></span><span class="op">(</span><span class="va">frink</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-6-8.png"><!-- --></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/transform.html">image_flop</a></span><span class="op">(</span><span class="va">frink</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-6-9.png"><!-- --></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Brightness, Saturation, Hue</span></span>
<span><span class="fu"><a href="../reference/color.html">image_modulate</a></span><span class="op">(</span><span class="va">frink</span>, brightness <span class="op">=</span> <span class="fl">80</span>, saturation <span class="op">=</span> <span class="fl">120</span>, hue <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-6-10.png"><!-- --></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Paint the shirt orange</span></span>
<span><span class="fu"><a href="../reference/painting.html">image_fill</a></span><span class="op">(</span><span class="va">frink</span>, <span class="st">"orange"</span>, point <span class="op">=</span> <span class="st">"+100+200"</span>, fuzz <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-6-11.png"><!-- --></p>
<p>With <code>image_fill</code> we can flood fill starting at pixel <code>point</code>. The <code>fuzz</code> parameter allows for the fill to cross for adjacent pixels with similarish colors. Its value must be between 0 and 256^2 specifying the max geometric distance between colors to be considered equal. Here we give professor frink an orange shirt for the World Cup.</p>
</div>
<div class="section level3">
<h3 id="filters-and-effects">Filters and effects<a class="anchor" aria-label="anchor" href="#filters-and-effects"></a>
</h3>
<p>ImageMagick also has a bunch of standard effects that are worth checking out.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add randomness</span></span>
<span><span class="fu"><a href="../reference/effects.html">image_blur</a></span><span class="op">(</span><span class="va">frink</span>, <span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-7-1.png"><!-- --></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/effects.html">image_noise</a></span><span class="op">(</span><span class="va">frink</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-7-2.png"><!-- --></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Silly filters</span></span>
<span><span class="fu"><a href="../reference/effects.html">image_charcoal</a></span><span class="op">(</span><span class="va">frink</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-7-3.png"><!-- --></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/effects.html">image_oilpaint</a></span><span class="op">(</span><span class="va">frink</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-7-4.png"><!-- --></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/effects.html">image_negate</a></span><span class="op">(</span><span class="va">frink</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-7-5.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="kernel-convolution">Kernel convolution<a class="anchor" aria-label="anchor" href="#kernel-convolution"></a>
</h3>
<p>The <code><a href="../reference/morphology.html">image_convolve()</a></code> function applies a <a href="https://en.wikipedia.org/wiki/Kernel_(image_processing)" class="external-link">kernel</a> over the image. Kernel convolution means that each pixel value is recalculated using the weighted neighborhood sum defined in the kernel matrix. For example lets look at this simple kernel:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kern</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, ncol <span class="op">=</span> <span class="fl">3</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">kern</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span>
<span><span class="va">kern</span><span class="op">[</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span>
<span><span class="va">kern</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span>
<span><span class="va">kern</span></span></code></pre></div>
<pre><code><span><span class="co">##      [,1] [,2] [,3]</span></span>
<span><span class="co">## [1,] 0.00 0.25 0.00</span></span>
<span><span class="co">## [2,] 0.25 0.00 0.25</span></span>
<span><span class="co">## [3,] 0.00 0.25 0.00</span></span></code></pre>
<p>This kernel changes each pixel to the mean of its horizontal and vertical neighboring pixels, which results in a slight blurring effect in the right-hand image below:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transform.html">image_resize</a></span><span class="op">(</span><span class="va">logo</span>, <span class="st">"300x300"</span><span class="op">)</span></span>
<span><span class="va">img_blurred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/morphology.html">image_convolve</a></span><span class="op">(</span><span class="va">img</span>, <span class="va">kern</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/animation.html">image_append</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">img</span>, <span class="va">img_blurred</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-9-1.gif"><!-- --></p>
<p>Or use any of the <a href="https://legacy.imagemagick.org/Usage/convolve/" class="external-link">standard kernels</a></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">img</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/morphology.html">image_convolve</a></span><span class="op">(</span><span class="st">'Sobel'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/effects.html">image_negate</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-10-1.gif"><!-- --></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">img</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/morphology.html">image_convolve</a></span><span class="op">(</span><span class="st">'DoG:0,0,2'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/effects.html">image_negate</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-10-2.gif"><!-- --></p>
</div>
<div class="section level3">
<h3 id="text-annotation">Text annotation<a class="anchor" aria-label="anchor" href="#text-annotation"></a>
</h3>
<p>Finally it can be useful to print some text on top of images:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add some text</span></span>
<span><span class="fu"><a href="../reference/painting.html">image_annotate</a></span><span class="op">(</span><span class="va">frink</span>, <span class="st">"I like R!"</span>, size <span class="op">=</span> <span class="fl">70</span>, gravity <span class="op">=</span> <span class="st">"southwest"</span>, color <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-11-1.png"><!-- --></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Customize text</span></span>
<span><span class="fu"><a href="../reference/painting.html">image_annotate</a></span><span class="op">(</span><span class="va">frink</span>, <span class="st">"CONFIDENTIAL"</span>, size <span class="op">=</span> <span class="fl">30</span>, color <span class="op">=</span> <span class="st">"red"</span>, boxcolor <span class="op">=</span> <span class="st">"pink"</span>,</span>
<span>  degrees <span class="op">=</span> <span class="fl">60</span>, location <span class="op">=</span> <span class="st">"+50+100"</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-11-2.png"><!-- --></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fonts may require ImageMagick has fontconfig</span></span>
<span><span class="fu"><a href="../reference/painting.html">image_annotate</a></span><span class="op">(</span><span class="va">frink</span>, <span class="st">"The quick brown fox"</span>, font <span class="op">=</span> <span class="st">'Times'</span>, size <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-11-3.png"><!-- --></p>
<p>Fonts that are supported on most platforms include <code>"sans"</code>, <code>"mono"</code>, <code>"serif"</code>, <code>"Times"</code>, <code>"Helvetica"</code>, <code>"Trebuchet"</code>, <code>"Georgia"</code>, <code>"Palatino"</code>or <code>"Comic Sans"</code>.</p>
</div>
<div class="section level3">
<h3 id="combining-with-pipes">Combining with pipes<a class="anchor" aria-label="anchor" href="#combining-with-pipes"></a>
</h3>
<p>Each of the image transformation functions returns a <strong>modified copy</strong> of the original image. It does not affect the original image.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">frink</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/editing.html">image_read</a></span><span class="op">(</span><span class="st">"https://jeroen.github.io/images/frink.png"</span><span class="op">)</span></span>
<span><span class="va">frink2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transform.html">image_scale</a></span><span class="op">(</span><span class="va">frink</span>, <span class="st">"100"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/attributes.html">image_info</a></span><span class="op">(</span><span class="va">frink</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   format width height colorspace matte filesize density</span></span>
<span><span class="co">## 1    PNG   220    445       sRGB  TRUE    73494   72x72</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/attributes.html">image_info</a></span><span class="op">(</span><span class="va">frink2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   format width height colorspace matte filesize density</span></span>
<span><span class="co">## 1    PNG   100    202       sRGB  TRUE        0   72x72</span></span></code></pre>
<p>Hence to combine transformations you need to chain them:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transform.html">image_rotate</a></span><span class="op">(</span><span class="va">frink</span>, <span class="fl">90</span><span class="op">)</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/color.html">image_background</a></span><span class="op">(</span><span class="va">test</span>, <span class="st">"blue"</span>, flatten <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/composite.html">image_border</a></span><span class="op">(</span><span class="va">test</span>, <span class="st">"red"</span>, <span class="st">"10x10"</span><span class="op">)</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/painting.html">image_annotate</a></span><span class="op">(</span><span class="va">test</span>, <span class="st">"This is how we combine transformations"</span>, color <span class="op">=</span> <span class="st">"white"</span>, size <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   format width height colorspace matte filesize density</span></span>
<span><span class="co">## 1    PNG   465    240       sRGB  TRUE        0   72x72</span></span></code></pre>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-13-1.png"><!-- --></p>
<p>Using pipe syntax makes it a bit more readable</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/editing.html">image_read</a></span><span class="op">(</span><span class="st">"https://jeroen.github.io/images/frink.png"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/transform.html">image_rotate</a></span><span class="op">(</span><span class="fl">270</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/color.html">image_background</a></span><span class="op">(</span><span class="st">"blue"</span>, flatten <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/composite.html">image_border</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"10x10"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/painting.html">image_annotate</a></span><span class="op">(</span><span class="st">"The same thing with pipes"</span>, color <span class="op">=</span> <span class="st">"white"</span>, size <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-14-1.png"><!-- --></p>
</div>
</div>
<div class="section level2">
<h2 id="image-vectors">Image Vectors<a class="anchor" aria-label="anchor" href="#image-vectors"></a>
</h2>
<p>The examples above concern single images. However all functions in magick have been vectorized to support working with layers, compositions or animation.</p>
<p>The standard base methods <code>[</code> <code>[[</code>, <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> and <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code> are used to manipulate vectors of images which can then be treated as layers or frames.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Download earth gif and make it a bit smaller for vignette</span></span>
<span><span class="va">earth</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/editing.html">image_read</a></span><span class="op">(</span><span class="st">"https://jeroen.github.io/images/earth.gif"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/transform.html">image_scale</a></span><span class="op">(</span><span class="st">"200x"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/color.html">image_quantize</a></span><span class="op">(</span><span class="fl">128</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">earth</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 44</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">earth</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-15-1.gif"><!-- --></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/attributes.html">image_info</a></span><span class="op">(</span><span class="va">earth</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   format width height colorspace matte filesize density</span></span>
<span><span class="co">## 1    GIF   200    200        RGB FALSE        0   72x72</span></span>
<span><span class="co">## 2    GIF   200    200        RGB  TRUE        0   72x72</span></span>
<span><span class="co">## 3    GIF   200    200        RGB  TRUE        0   72x72</span></span>
<span><span class="co">## 4    GIF   200    200        RGB  TRUE        0   72x72</span></span>
<span><span class="co">## 5    GIF   200    200        RGB  TRUE        0   72x72</span></span>
<span><span class="co">## 6    GIF   200    200        RGB  TRUE        0   72x72</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">earth</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/transform.html">image_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/painting.html">image_annotate</a></span><span class="op">(</span><span class="st">"meanwhile in Australia"</span>, size <span class="op">=</span> <span class="fl">20</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-15-2.gif"><!-- --></p>
<div class="section level3">
<h3 id="layers">Layers<a class="anchor" aria-label="anchor" href="#layers"></a>
</h3>
<p>We can stack layers on top of each other as we would in Photoshop:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bigdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/editing.html">image_read</a></span><span class="op">(</span><span class="st">'https://jeroen.github.io/images/bigdata.jpg'</span><span class="op">)</span></span>
<span><span class="va">frink</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/editing.html">image_read</a></span><span class="op">(</span><span class="st">"https://jeroen.github.io/images/frink.png"</span><span class="op">)</span></span>
<span><span class="va">logo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/editing.html">image_read</a></span><span class="op">(</span><span class="st">"https://jeroen.github.io/images/Rlogo.png"</span><span class="op">)</span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bigdata</span>, <span class="va">logo</span>, <span class="va">frink</span><span class="op">)</span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transform.html">image_scale</a></span><span class="op">(</span><span class="va">img</span>, <span class="st">"300x300"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/attributes.html">image_info</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   format width height colorspace matte filesize density</span></span>
<span><span class="co">## 1   JPEG   300    225       sRGB FALSE        0   72x72</span></span>
<span><span class="co">## 2    PNG   300    232       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 3    PNG   148    300       sRGB  TRUE        0   72x72</span></span></code></pre>
<p>A mosaic prints images on top of one another, expanding the output canvas such that that everything fits:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/animation.html">image_mosaic</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-17-1.png"><!-- --></p>
<p>Flattening combines the layers into a single image which has the size of the first image:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/animation.html">image_flatten</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-18-1.png"><!-- --></p>
<p>Flattening and mosaic allow for specifying alternative <a href="https://www.imagemagick.org/Magick++/Enumerations.html#CompositeOperator" class="external-link">composite operators</a>:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/animation.html">image_flatten</a></span><span class="op">(</span><span class="va">img</span>, <span class="st">'Add'</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-19-1.png"><!-- --></p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/animation.html">image_flatten</a></span><span class="op">(</span><span class="va">img</span>, <span class="st">'Modulate'</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-19-2.png"><!-- --></p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/animation.html">image_flatten</a></span><span class="op">(</span><span class="va">img</span>, <span class="st">'Minus'</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-19-3.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="combining">Combining<a class="anchor" aria-label="anchor" href="#combining"></a>
</h3>
<p>Appending means simply putting the frames next to each other:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/animation.html">image_append</a></span><span class="op">(</span><span class="fu"><a href="../reference/transform.html">image_scale</a></span><span class="op">(</span><span class="va">img</span>, <span class="st">"x200"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-20-1.png"><!-- --></p>
<p>Use <code>stack = TRUE</code> to position them on top of each other:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/animation.html">image_append</a></span><span class="op">(</span><span class="fu"><a href="../reference/transform.html">image_scale</a></span><span class="op">(</span><span class="va">img</span>, <span class="st">"100"</span><span class="op">)</span>, stack <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-21-1.png"><!-- --></p>
<p>Composing allows for combining two images on a specific position:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bigdatafrink</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transform.html">image_scale</a></span><span class="op">(</span><span class="fu"><a href="../reference/transform.html">image_rotate</a></span><span class="op">(</span><span class="fu"><a href="../reference/color.html">image_background</a></span><span class="op">(</span><span class="va">frink</span>, <span class="st">"none"</span><span class="op">)</span>, <span class="fl">300</span><span class="op">)</span>, <span class="st">"x200"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/composite.html">image_composite</a></span><span class="op">(</span><span class="fu"><a href="../reference/transform.html">image_scale</a></span><span class="op">(</span><span class="va">bigdata</span>, <span class="st">"x400"</span><span class="op">)</span>, <span class="va">bigdatafrink</span>, offset <span class="op">=</span> <span class="st">"+180+100"</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-22-1.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="pages">Pages<a class="anchor" aria-label="anchor" href="#pages"></a>
</h3>
<p>When reading a PDF document, each page becomes an element of the vector. Note that PDF gets rendered while reading so you need to specify the density immediately.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">manual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/editing.html">image_read_pdf</a></span><span class="op">(</span><span class="st">'https://cloud.r-project.org/web/packages/magick/magick.pdf'</span>, density <span class="op">=</span> <span class="fl">72</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/attributes.html">image_info</a></span><span class="op">(</span><span class="va">manual</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    format width height colorspace matte filesize density</span></span>
<span><span class="co">## 1     PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 2     PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 3     PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 4     PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 5     PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 6     PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 7     PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 8     PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 9     PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 10    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 11    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 12    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 13    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 14    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 15    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 16    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 17    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 18    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 19    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 20    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 21    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 22    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 23    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 24    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 25    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 26    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 27    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 28    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 29    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 30    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 31    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 32    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 33    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 34    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 35    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 36    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 37    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 38    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 39    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 40    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 41    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 42    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 43    PNG   612    792       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 44    PNG   612    792       sRGB  TRUE        0   72x72</span></span></code></pre>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">manual</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-23-1.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="animation">Animation<a class="anchor" aria-label="anchor" href="#animation"></a>
</h3>
<p>Instead of treating vector elements as layers, we can also make them frames in an animation!</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/animation.html">image_animate</a></span><span class="op">(</span><span class="fu"><a href="../reference/transform.html">image_scale</a></span><span class="op">(</span><span class="va">img</span>, <span class="st">"200x200"</span><span class="op">)</span>, fps <span class="op">=</span> <span class="fl">1</span>, dispose <span class="op">=</span> <span class="st">"previous"</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-24-1.gif"><!-- --></p>
<p>Morphing creates a sequence of <code>n</code> images that gradually morph one image into another. It makes animations</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newlogo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transform.html">image_scale</a></span><span class="op">(</span><span class="fu"><a href="../reference/editing.html">image_read</a></span><span class="op">(</span><span class="st">"https://jeroen.github.io/images/Rlogo.png"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">oldlogo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transform.html">image_scale</a></span><span class="op">(</span><span class="fu"><a href="../reference/editing.html">image_read</a></span><span class="op">(</span><span class="st">"https://jeroen.github.io/images/Rlogo-old.png"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/transform.html">image_resize</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">oldlogo</span>, <span class="va">newlogo</span><span class="op">)</span>, <span class="st">'200x150!'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/color.html">image_background</a></span><span class="op">(</span><span class="st">'white'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/animation.html">image_morph</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/animation.html">image_animate</a></span><span class="op">(</span>optimize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-25-1.gif"><!-- --></p>
<p>If you read in an existing GIF or Video file, each frame becomes a layer:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Foreground image</span></span>
<span><span class="va">banana</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/editing.html">image_read</a></span><span class="op">(</span><span class="st">"https://jeroen.github.io/images/banana.gif"</span><span class="op">)</span></span>
<span><span class="va">banana</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transform.html">image_scale</a></span><span class="op">(</span><span class="va">banana</span>, <span class="st">"150"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/attributes.html">image_info</a></span><span class="op">(</span><span class="va">banana</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   format width height colorspace matte filesize density</span></span>
<span><span class="co">## 1    GIF   150    148       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 2    GIF   150    148       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 3    GIF   150    148       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 4    GIF   150    148       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 5    GIF   150    148       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 6    GIF   150    148       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 7    GIF   150    148       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 8    GIF   150    148       sRGB  TRUE        0   72x72</span></span></code></pre>
<p>Manipulate the individual frames and put them back into an animation:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Background image</span></span>
<span><span class="va">background</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/color.html">image_background</a></span><span class="op">(</span><span class="fu"><a href="../reference/transform.html">image_scale</a></span><span class="op">(</span><span class="va">logo</span>, <span class="st">"200"</span><span class="op">)</span>, <span class="st">"white"</span>, flatten <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine and flatten frames</span></span>
<span><span class="va">frames</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/composite.html">image_composite</a></span><span class="op">(</span><span class="va">background</span>, <span class="va">banana</span>, offset <span class="op">=</span> <span class="st">"+70+30"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Turn frames into animation</span></span>
<span><span class="va">animation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/animation.html">image_animate</a></span><span class="op">(</span><span class="va">frames</span>, fps <span class="op">=</span> <span class="fl">10</span>, optimize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">animation</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   format width height colorspace matte filesize density</span></span>
<span><span class="co">## 1    gif   200    155       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 2    gif    94    105       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 3    gif   125    122       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 4    gif   108    118       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 5    gif   108    105       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 6    gif    92    105       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 7    gif   113    123       sRGB  TRUE        0   72x72</span></span>
<span><span class="co">## 8    gif   119    118       sRGB  TRUE        0   72x72</span></span></code></pre>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-27-1.gif"><!-- --></p>
<p>Animations can be saved as GIF of MPEG files:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/editing.html">image_write</a></span><span class="op">(</span><span class="va">animation</span>, <span class="st">"Rlogo-banana.gif"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="drawing-and-graphics">Drawing and Graphics<a class="anchor" aria-label="anchor" href="#drawing-and-graphics"></a>
</h2>
<p>A relatively recent addition to the package is a native R graphics device which produces a magick image object. This can either be used like a regular device for making plots, or alternatively to open a device which draws onto an existing image using pixel coordinates.</p>
<div class="section level3">
<h3 id="graphics-device">Graphics device<a class="anchor" aria-label="anchor" href="#graphics-device"></a>
</h3>
<p>The <code><a href="../reference/device.html">image_graph()</a></code> function opens a new graphics device similar to e.g. <code><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png()</a></code> or <code><a href="https://rdrr.io/r/grDevices/x11.html" class="external-link">x11()</a></code>. It returns an image object to which the plot(s) will be written. Each “page” in the plotting device will become a frame in the image object.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Produce image using graphics device</span></span>
<span><span class="va">fig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/device.html">image_graph</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">400</span>, height <span class="op">=</span> <span class="fl">400</span>, res <span class="op">=</span> <span class="fl">96</span><span class="op">)</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html" class="external-link">qplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">wt</span>, data <span class="op">=</span> <span class="va">mtcars</span>, colour <span class="op">=</span> <span class="va">cyl</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: `qplot()` was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## This warning is displayed once every 8 hours.</span></span>
<span><span class="co">## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span>
<span><span class="co">## generated.</span></span></code></pre>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>We can easily post-process the figure using regular image operations.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/composite.html">image_composite</a></span><span class="op">(</span><span class="va">fig</span>, <span class="va">frink</span>, offset <span class="op">=</span> <span class="st">"+70+30"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 7</span></span></span>
<span><span class="co">##   format width height colorspace matte filesize density</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> PNG      400    400 sRGB       TRUE         0 96x96</span></span></code></pre>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-29-1.png"><!-- --></p>
</div>
<div class="section level3">
<h3 id="drawing-device">Drawing device<a class="anchor" aria-label="anchor" href="#drawing-device"></a>
</h3>
<p>Another way to use the graphics device is to draw on top of an exiting image using pixel coordinates.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Or paint over an existing image</span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/device.html">image_draw</a></span><span class="op">(</span><span class="va">frink</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html" class="external-link">rect</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">200</span>, <span class="fl">100</span>, border <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, lwd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">300</span>, col <span class="op">=</span> <span class="st">'blue'</span>, lwd <span class="op">=</span> <span class="st">'10'</span>, lty <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">250</span>, <span class="st">"Hoiven-Glaven"</span>, family <span class="op">=</span> <span class="st">"monospace"</span>, cex <span class="op">=</span> <span class="fl">4</span>, srt <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html" class="external-link">palette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">11</span>, end <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/symbols.html" class="external-link">symbols</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">11</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">400</span>, <span class="fl">40</span><span class="op">)</span>, circles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">5</span>, <span class="fl">35</span><span class="op">)</span>,</span>
<span>  bg <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">11</span>, inches <span class="op">=</span> <span class="cn">FALSE</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 7</span></span></span>
<span><span class="co">##   format width height colorspace matte filesize density</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> PNG      220    445 sRGB       TRUE         0 72x72</span></span></code></pre>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-31-1.png"><!-- --></p>
<p>By default <code><a href="../reference/device.html">image_draw()</a></code> sets all margins to 0 and uses graphics coordinates to match image size in pixels (width x height) where (0,0) is the top left corner. Note that this means the y axis increases from top to bottom which is the opposite of typical graphics coordinates. You can override all this by passing custom <code>xlim</code>, <code>ylim</code> or <code>mar</code> values to <code>image_draw</code>.</p>
</div>
<div class="section level3">
<h3 id="animated-graphics">Animated Graphics<a class="anchor" aria-label="anchor" href="#animated-graphics"></a>
</h3>
<p>The graphics device supports multiple frames which makes it easy to create animated graphics. The code below shows how you would implement the example from the very cool <a href="https://gganimate.com/" class="external-link">gganimate</a> package using the magick graphics device.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jennybc/gapminder" class="external-link">gapminder</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/device.html">image_graph</a></span><span class="op">(</span><span class="fl">600</span>, <span class="fl">340</span>, res <span class="op">=</span> <span class="fl">96</span><span class="op">)</span></span>
<span><span class="va">datalist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">gapminder</span>, <span class="va">gapminder</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">datalist</span>, <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">gdpPercap</span>, <span class="va">lifeExp</span>, size <span class="op">=</span> <span class="va">pop</span>, color <span class="op">=</span> <span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size</a></span><span class="op">(</span><span class="st">"population"</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">90</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">$</span><span class="va">gdpPercap</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">year</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">animation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/animation.html">image_animate</a></span><span class="op">(</span><span class="va">img</span>, fps <span class="op">=</span> <span class="fl">2</span>, optimize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">animation</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 12 × 7</span></span></span>
<span><span class="co">##    format width height colorspace matte filesize density</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> gif      600    340 sRGB       TRUE         0 96x96  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> gif      384    240 sRGB       TRUE         0 96x96  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> gif      394    235 sRGB       TRUE         0 96x96  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> gif      373    229 sRGB       TRUE         0 96x96  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> gif      392    223 sRGB       TRUE         0 96x96  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> gif      373    232 sRGB       TRUE         0 96x96  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> gif      353    232 sRGB       TRUE         0 96x96  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> gif      307    208 sRGB       TRUE         0 96x96  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> gif      319    257 sRGB       TRUE         0 96x96  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> gif      330    216 sRGB       TRUE         0 96x96  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> gif      355    206 sRGB       TRUE         0 96x96  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> gif      345    206 sRGB       TRUE         0 96x96</span></span></code></pre>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-32-1.gif"><!-- --></p>
<p>To write it to a file you would simply do:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/editing.html">image_write</a></span><span class="op">(</span><span class="va">animation</span>, <span class="st">"gapminder.gif"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="raster-images">Raster Images<a class="anchor" aria-label="anchor" href="#raster-images"></a>
</h2>
<p>Magick images can also be converted to raster objects for use with R’s graphics device. Thereby we can combine it with other graphics tools. However do note that R’s graphics device is very slow and has a very different coordinate system which reduces the quality of the image.</p>
<div class="section level3">
<h3 id="base-r-rasters">Base R rasters<a class="anchor" aria-label="anchor" href="#base-r-rasters"></a>
</h3>
<p>Base R has an <code>as.raster</code> format which converts the image to a vector of strings. The paper <a href="https://journal.r-project.org/archive/2011-1/RJournal_2011-1_Murrell.pdf" class="external-link">Raster Images in R Graphics</a> by Paul Murrell gives a nice overview.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/as.raster.html" class="external-link">as.raster</a></span><span class="op">(</span><span class="va">frink</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print over another graphic</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rasterImage.html" class="external-link">rasterImage</a></span><span class="op">(</span><span class="va">frink</span>, <span class="fl">21</span>, <span class="fl">0</span>, <span class="fl">25</span>, <span class="fl">80</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-34-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="the-grid-package">The <code>grid</code> package<a class="anchor" aria-label="anchor" href="#the-grid-package"></a>
</h3>
<p>The <code>grid</code> package makes it easier to overlay a raster on the graphics device without having to adjust for the x/y coordinates of the plot.</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html" class="external-link">qplot</a></span><span class="op">(</span><span class="va">speed</span>, <span class="va">dist</span>, data <span class="op">=</span> <span class="va">cars</span>, geom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"point"</span>, <span class="st">"smooth"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code></pre>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grid/grid.raster.html" class="external-link">grid.raster</a></span><span class="op">(</span><span class="va">frink</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro_files/figure-html/unnamed-chunk-35-1.png" width="480"></p>
</div>
</div>
<div class="section level2">
<h2 id="ocr-text-extraction">OCR text extraction<a class="anchor" aria-label="anchor" href="#ocr-text-extraction"></a>
</h2>
<p>A recent addition to the package is to extract text from images using OCR. This requires the tesseract package:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tesseract"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/editing.html">image_read</a></span><span class="op">(</span><span class="st">"http://jeroen.github.io/images/testocr.png"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 7</span></span></span>
<span><span class="co">##   format width height colorspace matte filesize density</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> PNG      640    480 sRGB       TRUE     <span style="text-decoration: underline;">23</span>359 72x72</span></span></code></pre>
<p><img src="../../magick/articles/intro_files/figure-html/unnamed-chunk-37-1.png"><!-- --></p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract text</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="../reference/ocr.html">image_ocr</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## This is a lot of 12 point text to test the</span></span>
<span><span class="co">## ocr code and see if it works on all types</span></span>
<span><span class="co">## of file format.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The quick brown dog jumped over the</span></span>
<span><span class="co">## lazy fox. The quick brown dog jumped</span></span>
<span><span class="co">## over the lazy fox. The quick brown dog</span></span>
<span><span class="co">## jumped over the lazy fox. The quick</span></span>
<span><span class="co">## brown dog jumped over the lazy fox.</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
